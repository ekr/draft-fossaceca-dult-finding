<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Finding Tracking Tags</title>
<meta content="Christine Fossaceca" name="author">
<meta content="Eric Rescorla" name="author">
<meta content="
       Lightweight location tracking tags are in wide use to allow users
to locate items. These tags function as a component of a crowdsourced
tracking network in which devices belonging to other network
users (e.g., phones) report which
tags they see and their location, thus allowing the owner of the
tag to determine where their tag was most recently seen. This
document defines the protocol by which devices report tags
they have seen and by which owners look up their location. 
    " name="description">
<meta content="xml2rfc 3.22.0" name="generator">
<meta content="draft-fossaceca-dult-finding-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.22.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 69.5.1
    wcwidth 0.2.13
-->
<link href="draft-fossaceca-dult-finding.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Finding Tracking Tags</td>
<td class="right">July 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Fossaceca &amp; Rescorla</td>
<td class="center">Expires 18 January 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Detecting Unwanted Location Trackers</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-fossaceca-dult-finding-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-07-17" class="published">17 July 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-01-18">18 January 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Fossaceca</div>
<div class="org">Microsoft</div>
</div>
<div class="author">
      <div class="author-name">E. Rescorla</div>
<div class="org">Windy Hill Systems, LLC</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Finding Tracking Tags</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Lightweight location tracking tags are in wide use to allow users
to locate items. These tags function as a component of a crowdsourced
tracking network in which devices belonging to other network
users (e.g., phones) report which
tags they see and their location, thus allowing the owner of the
tag to determine where their tag was most recently seen. This
document defines the protocol by which devices report tags
they have seen and by which owners look up their location.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://ekr.github.io/draft-fossaceca-dult-finding/draft-fossaceca-dult-finding.html">https://ekr.github.io/draft-fossaceca-dult-finding/draft-fossaceca-dult-finding.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-fossaceca-dult-finding/">https://datatracker.ietf.org/doc/draft-fossaceca-dult-finding/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Detecting Unwanted Location Trackers Working Group mailing list (<span><a href="mailto:unwanted-trackers@ietf.org">mailto:unwanted-trackers@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/unwanted-trackers/">https://mailarchive.ietf.org/arch/browse/unwanted-trackers/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/unwanted-trackers/">https://www.ietf.org/mailman/listinfo/unwanted-trackers/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/ekr/draft-fossaceca-dult-finding">https://github.com/ekr/draft-fossaceca-dult-finding</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 18 January 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-motivations" class="internal xref">Motivations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-stalking-prevention" class="internal xref">Stalking Prevention</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-existing-protocols" class="internal xref">Existing Protocols</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1" class="keepWithNext"><a href="#section-2.2.1" class="auto internal xref">2.2.1</a>.  <a href="#name-apple-and-the-airtag-as-des" class="internal xref">Apple and the AirTag, as described in WhoTracks and Heinrich</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="auto internal xref">2.2.2</a>.  <a href="#name-samsung-and-the-smarttag-as" class="internal xref">Samsung and the SmartTag, as described in Samsung</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.3">
                    <p id="section-toc.1-1.2.2.2.2.3.1"><a href="#section-2.2.3" class="auto internal xref">2.2.3</a>.  <a href="#name-tile-cube-chipolo-pebblebee" class="internal xref">Tile, CUBE, Chipolo, Pebblebee and TrackR as described in GMCKV21</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-prior-research" class="internal xref">Prior Research</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-reporting-device-leakage" class="internal xref">Reporting Device Leakage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-non-compliant-accessories" class="internal xref">Non-compliant Accessories</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-rate-limiting-and-attestati" class="internal xref">Rate Limiting and Attestation</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-protocol-definition" class="internal xref">Protocol Definition</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-system-stages" class="internal xref">System Stages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-general-protocol-infrastruc" class="internal xref">General Protocol Infrastructure Properties</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-partial-blind-signature-sch" class="internal xref">Partial Blind Signature Scheme</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-initial-pairing-accessory-s" class="internal xref">Initial Pairing / Accessory Setup</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a href="#section-5.4.1" class="auto internal xref">5.4.1</a>.  <a href="#name-authenticity-verification" class="internal xref">Authenticity Verification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.2">
                    <p id="section-toc.1-1.5.2.4.2.2.1"><a href="#section-5.4.2" class="auto internal xref">5.4.2</a>.  <a href="#name-key-generation-and-signing-" class="internal xref">Key Generation and Signing with Partial Blind Signatures</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.3">
                    <p id="section-toc.1-1.5.2.4.2.3.1"><a href="#section-5.4.3" class="auto internal xref">5.4.3</a>.  <a href="#name-accessory-in-nearby-owner-m" class="internal xref">Accessory in Nearby Owner Mode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.4">
                    <p id="section-toc.1-1.5.2.4.2.4.1"><a href="#section-5.4.4" class="auto internal xref">5.4.4</a>.  <a href="#name-accessory-in-separated-lost" class="internal xref">Accessory in Separated (Lost) Mode</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-finder-device-creates-a-loc" class="internal xref">Finder Device creates a Location Report</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="auto internal xref">5.6</a>.  <a href="#name-owner-device-queries-the-cr" class="internal xref">Owner Device queries the Crowdsourced Network</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-effectiveness-of-rate-limit" class="internal xref">Effectiveness of Rate Limiting via Blind Signatures</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">DISCLAIMER: This draft is work-in-progress and has not yet seen significant (or
really any) security analysis. It should not be used as a basis for building
production systems. This published version of the draft has been designated
an "implementation draft" for testing and interop purposes.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Lightweight location tracking tags are a mechanism by which users can track their personal items. These tags function as a component of a crowdsourced
tracking network in which devices belonging to other network users
(e.g., phones) report on the location of tags they have seen.
At a high level, this works as follows:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">
          <p id="section-1-3.1.1">Tags ("Accessories") broadcast an advertisement payload containing
accessory-specific information. The payload also indicates whether
the accessory is separated from its owner and thus potentially lost.<a href="#section-1-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.2">
          <p id="section-1-3.2.1">Devices belonging to other users ("Non-Owner Devices" or "Finder Devices")
observe those payloads and if the payload is in a separated
mode, reports its location to some central service ("Crowdsourced Network").<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.3">
          <p id="section-1-3.3.1">The owner ("Owner Device") queries the central service ("Crowdsourced Network") for the location of their accessory.<a href="#section-1-3.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-4">A naive implementation of this design exposes users to considerable
privacy risk. In particular:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-5.1">
          <p id="section-1-5.1.1">If accessories simply have a fixed identifier that is reported back
to the tracking network, then the central server is able to track
any accessory without the user's assistance, which is clearly
undesirable.<a href="#section-1-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.2">
          <p id="section-1-5.2.1">Any attacker who can guess or determine a tag ID can query the central server
for its location.<a href="#section-1-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.3">
          <p id="section-1-5.3.1">An attacker can surreptitiously plant an accessory on a target
and thus track them by tracking their "own" accessory.<a href="#section-1-5.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-6"><a href="#security-considerations" class="auto internal xref">Section 6</a> provides more detailed definition of the
desired security privacy properties, but briefly, we would like to
have a system in which:<a href="#section-1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-7.1">
          <p id="section-1-7.1.1">Nobody other than the owner of an accessory would be able to learn
anything about the location of a given accessory.<a href="#section-1-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-7.2">
          <p id="section-1-7.2.1">It is possible to detect when an accessory is being used to track you.<a href="#section-1-7.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-7.3">
          <p id="section-1-7.3.1">It is not possible for accessories that do not adhere to the protocol to use the crowdsourced network protocol.<a href="#section-1-7.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-7.4">
          <p id="section-1-7.4.1">It is not possible for unverified accessories to use the crowdsourced network protocol.<a href="#section-1-7.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-8">This document defines a cryptographic reporting and finding protocol
which is intended to minimize these privacy risks. It is intended
to work in concert with the requirements defined in
<span>[<a href="#I-D.detecting-unwanted-location-trackers" class="cite xref">I-D.detecting-unwanted-location-trackers</a>]</span>, which facilitate
detection of unwanted tracking tags. This protocol design is based on existing academic research surrounding the security and privacy of bluetooth location tracking accessories on the market today, as described in <span>[<a href="#BlindMy" class="cite xref">BlindMy</a>]</span> and <span>[<a href="#GMCKV21" class="cite xref">GMCKV21</a>]</span> and closely follows
the design of <span>[<a href="#BlindMy" class="cite xref">BlindMy</a>]</span>.<a href="#section-1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="motivations">
<section id="section-2">
      <h2 id="name-motivations">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-motivations" class="section-name selfRef">Motivations</a>
      </h2>
<div id="stalking-prevention">
<section id="section-2.1">
        <h3 id="name-stalking-prevention">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-stalking-prevention" class="section-name selfRef">Stalking Prevention</a>
        </h3>
<p id="section-2.1-1">This work has been inspired by the negative security and privacy implications that were introduced by lightweight location tracking tags, and defined in part by <span>[<a href="#I-D.detecting-unwanted-location-trackers" class="cite xref">I-D.detecting-unwanted-location-trackers</a>]</span>. The full threat model is described in detail in <span>[<a href="#DultDoc4" class="cite xref">DultDoc4</a>]</span>, however, a significant element of the threat model lies in part with the security of the Crowdsourced Network, which will be discussed in detail here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">In addition to its designed uses, the Crowdsourced Network also provided stalkers with a means to anonymously upload and download location reports from BLE trackers. Thus, this document outlines the requirements and responsibilities of the Crowdsourced Network to verify the authenticity of the participants, while also preserving user privacy.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-3.1">
            <p id="section-2.1-3.1.1">First, the Crowdsourced Network should to ensure that only authentic Finding Devices are sending reports to the Crowdsourced Network, and this should occur via an authenticated and encrypted channel. This will help prevent malicious actors from interfering with location reporting services.<a href="#section-2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.2">
            <p id="section-2.1-3.2.1">Second, the Crowdsourced Network should ensure that only authorized Owner Devices are able to download location reports, and this should occur via an authenticated and encrypted channel. This will prevent malicious actors from unauthorized access of location data.<a href="#section-2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.3">
            <p id="section-2.1-3.3.1">Third, the Crowdsourced Network must follow basic security principles, such as storing location reports in an encrypted manner<a href="#section-2.1-3.3.1" class="pilcrow">¶</a></p>
<p id="section-2.1-3.3.2"><em>(The benefits of this requirement are self explanatory.)</em><a href="#section-2.1-3.3.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.4">
            <p id="section-2.1-3.4.1">Fourth, the Crowdsourced Network must validate that the accessory registered to an owner is valid.  This wil prevent malicious actors from leveraging counterfeit accessories.<a href="#section-2.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.5">
            <p id="section-2.1-3.5.1">Fifth, users should should be able to opt-out of their devices participating in the Crowdsourced Network.<a href="#section-2.1-3.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="existing-protocols">
<section id="section-2.2">
        <h3 id="name-existing-protocols">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-existing-protocols" class="section-name selfRef">Existing Protocols</a>
        </h3>
<p id="section-2.2-1">There are a variety of different products on the market today that leverage a Crowdsourced Network for location tracking. Currently, each manufacturer has designed its own implementation and product.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">These include:<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<div id="apple-and-the-airtag-as-described-in-whotracks-and-heinrich">
<section id="section-2.2.1">
          <h4 id="name-apple-and-the-airtag-as-des">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-apple-and-the-airtag-as-des" class="section-name selfRef">Apple and the AirTag, as described in <span class="cite xref">[WhoTracks]</span> and <span class="cite xref">[Heinrich]</span></a>
          </h4>
<p id="section-2.2.1-1">AirTags leverage rotating P224 public keys that are sent out as advertisements from the AirTag accessories (<code>ACC</code>) to nearby "Finder Devices" (<code>FD</code>s) on the Crowdsourced Network (<code>CN</code>). This public key allows the Finder Device to encrypt its own location information and send it to the <code>CN</code>, and the owner device is able to independently generate te correct decryption keys and request the encrypted reports from the <code>CN</code>.<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1-2">The issues found with this implementation are the following:<a href="#section-2.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-3.1">
              <p id="section-2.2.1-3.1.1">There is no authentication that occurs between the <code>ACC</code> and the <code>FD</code> on the network, so counterfeit <code>ACC</code>s are able to leverage <code>FD</code>s to upload location reports to Apple's on their behalf <code>CN</code> for any <code>ACC</code> mimicking the protocol. There should be authentication that prevents a rogue or non-conforming/counterfeit <code>ACC</code> from causing an <code>FD</code> to generate a location report.<a href="#section-2.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.1-3.2">
              <p id="section-2.2.1-3.2.1">There is no authentication that occurs between <code>FD</code> and <code>CN</code>, further verifying the validity that the report being uploaded is from an authentic <code>FD</code>, besides the fact that it is coming from a TLS protected, certificate pinned connection.<a href="#section-2.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.1-3.3">
              <p id="section-2.2.1-3.3.1">Anyone can download an encrypted report from Apple's <code>CN</code>, as shown in <span>[<a href="#Heinrich" class="cite xref">Heinrich</a>]</span><a href="#section-2.2.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="samsung-and-the-smarttag-as-described-in-samsung">
<section id="section-2.2.2">
          <h4 id="name-samsung-and-the-smarttag-as">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-samsung-and-the-smarttag-as" class="section-name selfRef">Samsung and the SmartTag, as described in <span class="cite xref">[Samsung]</span></a>
          </h4>
<p id="section-2.2.2-1">Each Samsung Smart Tags can advertise up to 51 different "private ids" that are tied to each specific <code>ACC</code> when they are outside of bluetooth range of the owner device. <code>FD</code>s are referred to as "online devices" or "helper devices", and these devices will send location reports to Samsung's <code>CN</code>, where there is an option to encrypt the location data.<a href="#section-2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2-2">The issues found with this implementation, in addition to the issues described above are the following:<a href="#section-2.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2-3.1">
              <p id="section-2.2.2-3.1.1">The privacy ids are easily enumerable, meaning that a stalker could permanently track a Smart Tag <code>ACC</code>.<a href="#section-2.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.2-3.2">
              <p id="section-2.2.2-3.2.1">The <code>CN</code> is easily susceptible to replay attacks from inauthentic <code>FD</code>s<a href="#section-2.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.2-3.3">
              <p id="section-2.2.2-3.3.1">It is possible for an <code>ACC</code> to be impersonated and pair with the <code>OD</code>.<a href="#section-2.2.2-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.2-3.4">
              <p id="section-2.2.2-3.4.1">There is sensitive, unique data that can be leaked by the GATT service used by an <code>FD</code> on an <code>ACC</code><a href="#section-2.2.2-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.2-3.5">
              <p id="section-2.2.2-3.5.1">The <code>CN</code> (and therefore, Samsung) is able to trivially track <code>ACC</code> due to the sensitive information stored on the server (private device ID and location information)<a href="#section-2.2.2-3.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="tile-cube-chipolo-pebblebee-and-trackr-as-described-in-gmckv21">
<section id="section-2.2.3">
          <h4 id="name-tile-cube-chipolo-pebblebee">
<a href="#section-2.2.3" class="section-number selfRef">2.2.3. </a><a href="#name-tile-cube-chipolo-pebblebee" class="section-name selfRef">Tile, CUBE, Chipolo, Pebblebee and TrackR as described in <span class="cite xref">[GMCKV21]</span></a>
          </h4>
<p id="section-2.2.3-1">These <code>CN</code>s are somewhat similar to each other because they all leverage apps to create their <code>CN</code>, rather than being built into the device operating system, as with Apple and Samsung. Because of this, it is a significant drawback for their <code>CN</code> network as participation of <code>FD</code>s is severely limited. However, there are certain security problems with this network that are important to discuss.<a href="#section-2.2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.2.3-2">Specifically, the authors identified various "security properties" that they believe to be an ideal <code>CN</code> benchmark, and defined those eight properties as follows:<a href="#section-2.2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.2.3-3"><em>(Definitions from <span>[<a href="#GMCKV21" class="cite xref">GMCKV21</a>]</span>)</em><a href="#section-2.2.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.3-4.1">
              <p id="section-2.2.3-4.1.1"><em>The <code>ACC</code> must able to recognize its owners</em><a href="#section-2.2.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.3-4.2">
              <p id="section-2.2.3-4.2.1"><em>The <code>CN</code> must able to recognize the owners of a given <code>ACC</code></em><a href="#section-2.2.3-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.3-4.3">
              <p id="section-2.2.3-4.3.1"><em>Owning of a <code>ACC</code> must involve performing a physical action on the <code>ACC</code></em><a href="#section-2.2.3-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.3-4.4">
              <p id="section-2.2.3-4.4.1"><em>Registering as a owner of a <code>ACC</code> with the <code>CN</code> must involve communicating with the <code>ACC</code></em><a href="#section-2.2.3-4.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.3-4.5">
              <p id="section-2.2.3-4.5.1"><em>The <code>FD</code> can update the location of an <code>ACC</code> if and only if the <code>FD</code> can communicate with the <code>ACC</code></em><a href="#section-2.2.3-4.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.3-4.6">
              <p id="section-2.2.3-4.6.1"><em>It must be impossible to spoof a given <code>ACC</code></em><a href="#section-2.2.3-4.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.3-4.7">
              <p id="section-2.2.3-4.7.1"><em>It must be impossible to spoof a location by an<code>FD</code></em><a href="#section-2.2.3-4.7.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.3-4.8">
              <p id="section-2.2.3-4.8.1"><em>It must be impossible to spoof the <code>CN</code></em><a href="#section-2.2.3-4.8.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.2.3-5">Their research then evaluated these existing <code>CN</code>s based on the benchmark they designed. The issues discovered were:<a href="#section-2.2.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.3-6.1">
              <p id="section-2.2.3-6.1.1">The TrackR, CUBE, Chipolo, and Pebblebee all allow for an <code>OD</code> to register an <code>ACC</code> with the <code>CN</code> without requiring any physical access to the <code>ACC</code> because the pairing/ registration process is too simplistic and only relies on the MAC address (or another static ID) of the device, which allows anyone to register as the owner of any arbitrary <code>ACC</code>.<a href="#section-2.2.3-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.3-6.2">
              <p id="section-2.2.3-6.2.1">All of the of the <code>CN</code>s (except for Tile) simply track <code>ACC</code>s with static identifiers of the device so like the Samsung network, the <code>CN</code>s can track arbitrary <code>ACC</code> locations<a href="#section-2.2.3-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.3-6.3">
              <p id="section-2.2.3-6.3.1">Most of the <code>CN</code>s blindly trust received location reports from <code>FD</code>s without verifying physical proximity to the <code>ACC</code>.<a href="#section-2.2.3-6.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="prior-research">
<section id="section-2.3">
        <h3 id="name-prior-research">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-prior-research" class="section-name selfRef">Prior Research</a>
        </h3>
<p id="section-2.3-1">There is substantial research into stalking via the FindMy protocol and overall crowdsourced network protocol deficiencies have been described in multiple bodies of work, such as:<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-2.1">
            <p id="section-2.3-2.1.1"><span>[<a href="#GMCKV21" class="cite xref">GMCKV21</a>]</span><a href="#section-2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-2.2">
            <p id="section-2.3-2.2.1"><span>[<a href="#Heinrich" class="cite xref">Heinrich</a>]</span><a href="#section-2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-2.3">
            <p id="section-2.3-2.3.1"><span>[<a href="#WhoTracks" class="cite xref">WhoTracks</a>]</span><a href="#section-2.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-2.4">
            <p id="section-2.3-2.4.1"><span>[<a href="#BlindMy" class="cite xref">BlindMy</a>]</span><a href="#section-2.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-2.5">
            <p id="section-2.3-2.5.1"><span>[<a href="#Beck" class="cite xref">Beck</a>]</span><a href="#section-2.3-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.3-3">and others.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3-4">There are some suggested improvements, such as the security properties described in <span>[<a href="#GMCKV21" class="cite xref">GMCKV21</a>]</span> above.  The authors of <span>[<a href="#GMCKV21" class="cite xref">GMCKV21</a>]</span> also suggested fusing a private key into the <code>ACC</code> to make it more difficult to spoof, and requiring that location updates be signed.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
<p id="section-2.3-5"><span>[<a href="#Heinrich" class="cite xref">Heinrich</a>]</span> and <span>[<a href="#WhoTracks" class="cite xref">WhoTracks</a>]</span> pointed out early deficiencies in the protocol, which <span>[<a href="#BlindMy" class="cite xref">BlindMy</a>]</span> set out to solve. By introducing a Blind Signature scheme, the authors sought to overcome an attacker leveraging a large amount of keys to avoid triggering the anti-tracking framework.  In this implementation, keys were predetermined for a set interval, and signed by the server, such that a specific, presigned key can only be used during a pre-determined interval. The drawback of this approach is that the authentication is left to the <code>OD</code> and the <code>CN</code>, and the <code>CN</code> does not do any authentication with the <code>FD</code>, so it still could store forged location reports. Additionally, the <code>FD</code> does not do any authentication with the <code>ACC</code>, which means that it could potentially interact with counterfeit <code>ACC</code> devices.<a href="#section-2.3-5" class="pilcrow">¶</a></p>
<p id="section-2.3-6"><span>[<a href="#Beck" class="cite xref">Beck</a>]</span> introduces the idea of Multi-Dealer Secret Sharing (MDSS) as a privacy preserving protocol that should also be considered.<a href="#section-2.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-3">
      <h2 id="name-conventions-and-definitions">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-3-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Section 1.2 of <span>[<a href="#I-D.detecting-unwanted-location-trackers" class="cite xref">I-D.detecting-unwanted-location-trackers</a>]</span> provides
definitions of the various system components.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Accessory (ACC): This is the device which will be tracked. It is assumed to lack direct internet access and GPS, but will possess Bluetooth Low Energy capabilities, which it uses to send advertisement messages. The accessory protocol is defined in <span>[<a href="#DultDoc3" class="cite xref">DultDoc3</a>]</span>.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Advertisement: This is the message that is sent over the BLE Protocol from the Accessory<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">Crowdsourced Network (CN): This is the network that provides the location reporting upload and download services for Owner Devices and Finder Devices.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">Finder Device (FD): This is a device that is a non-owner device that contributes information about an accessory to the crowdsourced network.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">Owner Device (OD): This is the device which owns the accessory, and to which it is paired. There can be multiple owner devices, however, the security of that implementation is outside of the scope of this document.<a href="#section-3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol-overview">
<section id="section-4">
      <h2 id="name-protocol-overview">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-4-1"><a href="#fig-protocol-overview" class="auto internal xref">Figure 1</a> provides an overall view of the protocol.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">In this protocol, the Accessory communicates to Finder Devices or
<code>FDs</code>(such as phones) solely via Bluetooth, and the <code>FDs</code> communicate
to a centralized service on the Crowdsourced Network <code>CN</code>. Only during
the setup phase is the Owner Device <code>OD</code> able to act as a relay
between the Accessory <code>ACC</code> and the Crowdsourced Network <code>CN</code>. In this
implementation, the <code>CN</code> is able to act as a verifier and signer by
leveraging Blind Signatures, which allows the <code>OD</code> to obtain a
signature from the signer <code>CN</code> without revealing the input to the
<code>CN</code>.<a href="#section-4-2" class="pilcrow">¶</a></p>
<span id="name-protocol-overview-2"></span><div id="fig-protocol-overview">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-4-3.1">
<pre>
                              ╭――――――――――――――――――╮
                              │        o         │
                              │ ╭──────────────╮ │
                              │ │              │ │
                              │ │              │ │                        .-~~~-.
                              │ │              │ │                .- ~ ~-(       )_ _
    o  o                      │ │              │ │               /                     ~ -.
 o        o                   │ │              │ │              |                           \
o          o     -------&gt;     │ │              │ │   -------&gt;    \                         .'
o          o                  │ │              │ │                 ~- . _____________ . -~
 o        o                   │ │              │ │
    o  o                      │ │              │ │
                              │ │              │ │
                              │ ╰──────────────╯ │
                              │       (_)        │
                              ╰――――――――――――――――――╯



  Accessory         BLE           Finder Device      Location            CN Server
               Advertisement                          Upload



</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-protocol-overview-2" class="selfRef">Protocol Overview</a>
        </figcaption></figure>
</div>
<p id="section-4-4">As part of the setup phase (<a href="#setup" class="auto internal xref">Section 5.4</a>) the accessory and
owning device are paired, establishing a shared key <code>SK</code>
which is known to both the accessory and the owning device.
The rest of the protocol proceeds as follows.<a href="#section-4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-5.1">
          <p id="section-4-5.1.1">The accessory periodically sends out an advertisement which contains
an ephemeral public key <code>Y_i</code> where <code>i</code> is the epoch the key is valid
for (e.g., a one hour window). <code>Y_i</code> and its corresponding private key
<code>X_i</code> are generated in a deterministic fashion from <code>SK</code> and the epoch
<code>i</code> (conceptually as a <code>X_i = PRF(SK, i)</code>).<a href="#section-4-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-5.2">
          <p id="section-4-5.2.1">In order to report an accessory's location at time <code>i</code> a non-owning
device <code>FD</code> encrypts it under <code>Y_i</code> and transmits the pair
<code>( E(Y_i, location), Y_i )</code> to the central service <code>CN</code>.<a href="#section-4-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-5.3">
          <p id="section-4-5.3.1">In order to locate an accessory at time <code>i</code>, the owner uses <code>SK</code> to
compute <code>(X_i, Y_i)</code> and then sends <code>Y_i</code> to the central service.
The central service responds with all the reports it has for <code>Y_i</code>,
and the owner decrypts them with <code>X_i</code>.<a href="#section-4-5.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-6">This design provides substantially improved privacy properties
over a naive design:<a href="#section-4-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4-7">
<li id="section-4-7.1">
          <p id="section-4-7.1.1">Nobody but the owner can learn the reported location of an
accessory because it is encrypted under <code>Y_i</code>. This includes
the central service, which just sees encrypted reports.<a href="#section-4-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-7.2">
          <p id="section-4-7.2.1">It is not possible to correlate the public keys broadcast
across multiple epochs without knowing the shared key <code>SK</code>,
which is only know to the owner. However, an observer who
sees multiple beacons within the same epoch can correlate
them, as they will have the same <code>Y_i</code>. However, fast key
rotation also makes it more difficult to detect unwanted
tracking, which relies on multiple observations of the
same identifier over time.<a href="#section-4-7.2.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-4-8">However, there are a number of residual privacy threats, as described below.<a href="#section-4-8" class="pilcrow">¶</a></p>
<div id="reporting-device-leakage">
<section id="section-4.1">
        <h3 id="name-reporting-device-leakage">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-reporting-device-leakage" class="section-name selfRef">Reporting Device Leakage</a>
        </h3>
<p id="section-4.1-1">If the central server is able to learn the identity of the device
reporting an accessory or the identity of the owner requesting the location
of an accessory, then it can infer information about that accessory's
behavior. For instance:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">
            <p id="section-4.1-2.1.1">If device A reports accessories X and Y owned by different users and
they both query for their devices, then the central server
may learn that those users were in the same place, or at least
their accessories were.<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.2">
            <p id="section-4.1-2.2.1">If devices A and B both report tag X, then the server learns that
A and B were in the same place.<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.3">
            <p id="section-4.1-2.3.1">If the central server is able to learn where a reporting device
is (e.g., by IP address) and then the user queries for that
accessory, then the server can infer information about where
the user was, or at least where they lost the accessory.<a href="#section-4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-3">These issues can be mitigated by concealing the identity and/or
IP address of network elements communicating with the central
server using techniques such as Oblivious HTTP <span>[<a href="#RFC9458" class="cite xref">RFC9458</a>]</span> or
MASQUE <span>[<a href="#RFC9298" class="cite xref">RFC9298</a>]</span>.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="non-compliant-accessories">
<section id="section-4.2">
        <h3 id="name-non-compliant-accessories">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-non-compliant-accessories" class="section-name selfRef">Non-compliant Accessories</a>
        </h3>
<p id="section-4.2-1">The detection mechanisms described in
<span>[<a href="#I-D.detecting-unwanted-location-trackers" class="cite xref">I-D.detecting-unwanted-location-trackers</a>]</span> depend on correct
behavior from the tracker. For instance, <span><a href="https://datatracker.ietf.org/doc/html/draft-detecting-unwanted-location-trackers-01#section-3.5.1" class="relref">Section 3.5.1</a> of [<a href="#I-D.detecting-unwanted-location-trackers" class="cite xref">I-D.detecting-unwanted-location-trackers</a>]</span> requires that
accessories use a rotation period of 24 hours when in
the "separated" state:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">When in a separated state, the accessory <span class="bcp14">SHALL</span> rotate its address
   every 24 hours.  This duration allows a platform's unwanted
   tracking algorithms to detect that the same accessory is in
   proximity for some period of time, when the owner is not in
   physical proximity.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">However, if an attacker were to make their own accessory that was
generated the right beacon messages or modify an existing one, they
could cause it to rotate the MAC address and public key <code>Y_i</code> more
frequently, thus evading detection algorithms. The following section
describes a mechanism which is intended to mitigate
this attack.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<div id="rate-limiting-and-attestation">
<section id="section-4.2.1">
          <h4 id="name-rate-limiting-and-attestati">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-rate-limiting-and-attestati" class="section-name selfRef">Rate Limiting and Attestation</a>
          </h4>
<p id="section-4.2.1-1">Because evading detection requires rapidly changing keys, evasion
can be made more difficult by limiting the rate at which keys
can change. This rate limiting works as follows:<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.1-2">
<li id="section-4.2.1-2.1">
              <p id="section-4.2.1-2.1.1">Instead of allowing the accessory to publish an arbitrary
key <code>Y_i</code> it instead must pre-generate a set of keys,
one for each time window.<a href="#section-4.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.1-2.2">
              <p id="section-4.2.1-2.2.1">During the setup/pairing phase, the accessory and owning
device interact with the central service, which
signs each temporal key using a blind signature scheme.
The owning device stores the signatures for each key <code>Y_i</code>.<a href="#section-4.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.1-2.3">
              <p id="section-4.2.1-2.3.1">When it wishes to retrieve the location for a given accessory
the owning device provides the central service with the
corresponding signature, thus proving that it is retrieving
location for a pre-registered key; the central service
will refuse to provide results for unsigned keys.<a href="#section-4.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-4.2.1-3">Note that this mechanism <em>does not</em> prevent the accessory
from broadcasting arbitrary keys, but it cannot retrieve
location reports corresponding to those keys.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<p id="section-4.2.1-4">This is not a complete defense: it limits an attacker who owns
a single accessory to a small number of keys per time window,
but an attacker who purchases N devices can then use N times
that many keys per window, potentially coordinating usage across
spatially separated devices to reduce the per-device cost.
[[OPEN ISSUE: Can we do better than this?]]<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="protocol-definition">
<section id="section-5">
      <h2 id="name-protocol-definition">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-protocol-definition" class="section-name selfRef">Protocol Definition</a>
      </h2>
<p id="section-5-1">This section provides a detailed description of the DULT Finding Protocol.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="system-stages">
<section id="section-5.1">
        <h3 id="name-system-stages">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-system-stages" class="section-name selfRef">System Stages</a>
        </h3>
<p id="section-5.1-1">The there are 5 stages that will be outlined, taking into account elements from both <span>[<a href="#BlindMy" class="cite xref">BlindMy</a>]</span> and <span>[<a href="#GMCKV21" class="cite xref">GMCKV21</a>]</span>.  These stages are as follows:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">1) <strong>Initial Pairing / Accessory Setup</strong><a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">In this phase, the Accessory <code>ACC</code> is paired with the Owner Device <code>OD</code>, and verified as authentic with the Crowdsourced Network <code>CN</code><a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">2) <strong>Accessory in Nearby Owner Mode</strong><a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">In this phase, the Accessory <code>ACC</code> is within Bluetooth range of the Owner Device <code>OD</code>. In this phase, Finder Devices <code>FDs</code> <span class="bcp14">SHALL NOT</span> generate location reports to send to the Crowdsourced Network <code>CN</code>. The Accessory <span class="bcp14">SHALL</span> behave as defined in <span>[<a href="#DultDoc3" class="cite xref">DultDoc3</a>]</span>. [[OPEN ISSUE: Need to make sure that walking around with an AirTag in Nearby Mode does not allow for stalking]]<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">3) <strong>Accessory in Separated (Lost) Mode</strong><a href="#section-5.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1-7">In this phase, the Accessory <code>ACC</code> is not within Bluetooth raange fo the Owner Device <code>OD</code>, therefore, the accessory must generate "lost" messages to be received by Finder Devices <code>FD</code>, as described in <span>[<a href="#DultDoc3" class="cite xref">DultDoc3</a>]</span>.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<p id="section-5.1-8">4) <strong>Finder Device creates a location report</strong><a href="#section-5.1-8" class="pilcrow">¶</a></p>
<p id="section-5.1-9">Finder Device <code>FD</code> receives a Bluetooth packet, and uploads a location report to the Crowdsourced Network <code>CN</code> if and only if it is confirmed to be a valid location report.<a href="#section-5.1-9" class="pilcrow">¶</a></p>
<p id="section-5.1-10">[[OPEN ISSUE: Should this be confirmed by the FD, or the CN? or Both?]]<a href="#section-5.1-10" class="pilcrow">¶</a></p>
<p id="section-5.1-11">[[OPEN ISSUE: Should there be auth between <code>FD</code> and <code>ACC</code> as well as <code>FD</code> and <code>CN</code>]]<a href="#section-5.1-11" class="pilcrow">¶</a></p>
<p id="section-5.1-12">5) <strong>Owner Device queries the Crowdsourced Network</strong><a href="#section-5.1-12" class="pilcrow">¶</a></p>
<p id="section-5.1-13">Owner Device <code>OD</code> queries the Crowdsourced Network <code>CN</code> for the encrypted location report.<a href="#section-5.1-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="general-protocol-infrastructure-properties">
<section id="section-5.2">
        <h3 id="name-general-protocol-infrastruc">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-general-protocol-infrastruc" class="section-name selfRef">General Protocol Infrastructure Properties</a>
        </h3>
<p id="section-5.2-1">We define the following constraints, adapted from <span>[<a href="#BlindMy" class="cite xref">BlindMy</a>]</span> Section 4.2.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-2.1">
            <p id="section-5.2-2.1.1">There exists an agreed upon elliptic curve group with a generator,
a secure Message Authentication Algorithm, and a hashing
function <em>H</em>.<a href="#section-5.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-2.2">
            <p id="section-5.2-2.2.1"><code>CN</code> knows a key pair <code>(K</code><sub>S</sub>,<code>P</code><sub>S</sub><code>)</code>, where the public key
<code>P</code><sub>S</sub> is known to all participants.<a href="#section-5.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-2.3">
            <p id="section-5.2-2.3.1"><code>CN</code> has a private symmetric encryption key K<sub>SERIAL</sub>.<a href="#section-5.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-2.4">
            <p id="section-5.2-2.4.1"><code>CN</code> maintains a database of registered serial values D<sub>SERIAL</sub>
[[OPEN ISSUE: Does this create a privacy concern? ]]<a href="#section-5.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-2.5">
            <p id="section-5.2-2.5.1">Each Accessory <code>ACC</code><sub>i</sub> is provisioned with a unique
serial number and tag (<code>Serial</code><sub>i</sub>, <code>T</code><sub>i</sub>),
where the tag is a MAC computed over D<sub>SERIAL</sub>.<a href="#section-5.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-2.6">
            <p id="section-5.2-2.6.1">All parties have a synchronized clock and the ability to represent the current day (or another arbitrary timestamp) as an integer<a href="#section-5.2-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-2.7">
            <p id="section-5.2-2.7.1">A parameter <em>N</em> is defined by the protocol that represents the number of encryption keys produced during the pairing algorithm.<a href="#section-5.2-2.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="partial-blind-signature-scheme">
<section id="section-5.3">
        <h3 id="name-partial-blind-signature-sch">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-partial-blind-signature-sch" class="section-name selfRef">Partial Blind Signature Scheme</a>
        </h3>
<p id="section-5.3-1">[[OPEN ISSUE: Which blind signature scheme to use.]]
In order to verify the parties involved in the protocol, we rely on a
partially blind signature scheme. <span>[<a href="#RFC9474" class="cite xref">RFC9474</a>]</span> describes a blind signature
scheme as follows:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">The RSA Blind Signature Protocol is a two-party protocol between a
   client and server where they interact to compute sig = Sign(sk,
   input_msg), where input_msg = Prepare(msg) is a prepared version of
   the private message msg provided by the client, and sk is the private
   signing key provided by the server.  See Section 6.2 for details on
   how sk is generated and used in this protocol.  Upon completion of
   this protocol, the server learns nothing, whereas the client learns
   sig.  In particular, this means the server learns nothing of msg or
   input_msg and the client learns nothing of sk.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">The Finding Protocol uses a partially blind signature scheme in which
the signature also covers an additional <code>info</code> value which is not
kept secret from the signing server.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="setup">
<section id="section-5.4">
        <h3 id="name-initial-pairing-accessory-s">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-initial-pairing-accessory-s" class="section-name selfRef">Initial Pairing / Accessory Setup</a>
        </h3>
<p id="section-5.4-1">During the pairing process, the Accessory <code>ACC</code> pairs with the Owner
Device <code>OD</code> over Bluetooth. In this process, the <code>ACC</code> and <code>OD</code> must
generate cryptographically secure keys that will allow for the <code>OD</code> to
decrypt the <code>ACC</code> location reports.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<div id="authenticity-verification">
<section id="section-5.4.1">
          <h4 id="name-authenticity-verification">
<a href="#section-5.4.1" class="section-number selfRef">5.4.1. </a><a href="#name-authenticity-verification" class="section-name selfRef">Authenticity Verification</a>
          </h4>
<p id="section-5.4.1-1">Upon the initial pairing of the the <code>ACC</code> and <code>OD</code>, before the key
generation process, the <code>OD</code> must facilitate communication with the
<code>CN</code> to verify the authenticity of the <code>ACC</code>.<a href="#section-5.4.1-1" class="pilcrow">¶</a></p>
<p id="section-5.4.1-2">The precise details of this communication are implementation-dependent,
but at the end of this process the <code>CN</code> must be able to verify that:<a href="#section-5.4.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.1-3">
<li id="section-5.4.1-3.1">
              <p id="section-5.4.1-3.1.1">The <code>ACC</code> is a legitimate (i.e., authorized) device.<a href="#section-5.4.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.1-3.2">
              <p id="section-5.4.1-3.2.1">The <code>ACC</code> has not already been registered.<a href="#section-5.4.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-5.4.1-4">For instance, each <code>ACC</code> might be provisioned with a unique serial
number which is digitally signed by the manufacturer, thus allowing
the <code>CN</code> to verify legitimacy. The <code>CN</code> could use a database of
registered serial numbers to prevent multiple registrations.
Once registration is complete, there must be some mechanism for
the <code>OD</code> to maintain continuity of authentication; this too is
implementation specific.<a href="#section-5.4.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-generation-and-signing-with-partial-blind-signatures">
<section id="section-5.4.2">
          <h4 id="name-key-generation-and-signing-">
<a href="#section-5.4.2" class="section-number selfRef">5.4.2. </a><a href="#name-key-generation-and-signing-" class="section-name selfRef">Key Generation and Signing with Partial Blind Signatures</a>
          </h4>
<p id="section-5.4.2-1">The <code>ACC</code> must periodically be provisioned with new temporal
keys which FDs can then use to encrypt reports. Each temporal key
is associated with a given timestamp value,<a href="#section-5.4.2-1" class="pilcrow">¶</a></p>
<p id="section-5.4.2-2">Once the <code>ACC</code> has been authorized, the <code>ACC</code> (or <code>OD</code> on its behalf)
needs to generate its temporal encryption keys <code>Y_i</code>. It then generates
a signing request for the blinded version of each key.<a href="#section-5.4.2-2" class="pilcrow">¶</a></p>
<p id="section-5.4.2-3">contains two values:<a href="#section-5.4.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.4.2-4">
            <dt id="section-5.4.2-4.1">blindedKey</dt>
            <dd style="margin-left: 1.5em" id="section-5.4.2-4.2">
              <p id="section-5.4.2-4.2.1">An opaque string representing the key to be signed, computed as below.<a href="#section-5.4.2-4.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.4.2-4.3">timestamp</dt>
            <dd style="margin-left: 1.5em" id="section-5.4.2-4.4">
              <p id="section-5.4.2-4.4.1">The time value for the first time when the key will be used in
seconds since the UNIX epoch<a href="#section-5.4.2-4.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<div class="alignLeft art-text artwork" id="section-5.4.2-5">
<pre>
blindedKey = Blind(pk, Y_i, info)
</pre><a href="#section-5.4.2-5" class="pilcrow">¶</a>
</div>
<p id="section-5.4.2-6">With the following inputs:<a href="#section-5.4.2-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.4.2-7">
            <dt id="section-5.4.2-7.1">pk</dt>
            <dd style="margin-left: 1.5em" id="section-5.4.2-7.2">
              <p id="section-5.4.2-7.2.1">The public key for <code>CN</code><a href="#section-5.4.2-7.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.4.2-7.3">Y_i</dt>
            <dd style="margin-left: 1.5em" id="section-5.4.2-7.4">
              <p id="section-5.4.2-7.4.1">The temporal key to be signed<a href="#section-5.4.2-7.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.4.2-7.5">info</dt>
            <dd style="margin-left: 1.5em" id="section-5.4.2-7.6">
              <p id="section-5.4.2-7.6.1">The timestamp value serialized as an unsigned 64-bit integer
in network byte order.<a href="#section-5.4.2-7.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.4.2-8">Prior to signing the key, the <code>CN</code> must ensure the acceptability of the timestamp.
While the details are implementation dependent, this generally involves
enforcing rate limits on how many keys can be signed with timestamps
within a given window. Once the <code>CN</code> is satisfied with the submission
it constructs a blind signature as shown below and returns it to the <code>OD</code>.<a href="#section-5.4.2-8" class="pilcrow">¶</a></p>
<p id="section-5.4.2-9">[[OPEN ISSUE: Is it safe for <code>ACC</code> to hold all of the precomputed keys? Or does this create a privacy issue? ]]<a href="#section-5.4.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4.2-10">
<pre>
    BlindSign(sk, blindedKey, info)
</pre><a href="#section-5.4.2-10" class="pilcrow">¶</a>
</div>
<p id="section-5.4.2-11">With the following inputs<a href="#section-5.4.2-11" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.4.2-12">
            <dt id="section-5.4.2-12.1">sk</dt>
            <dd style="margin-left: 1.5em" id="section-5.4.2-12.2">
              <p id="section-5.4.2-12.2.1">The secret key for <code>CN</code><a href="#section-5.4.2-12.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.4.2-12.3">blindedKey</dt>
            <dd style="margin-left: 1.5em" id="section-5.4.2-12.4">
              <p id="section-5.4.2-12.4.1">The raw bytes of the blinded key provided by <code>CN</code><a href="#section-5.4.2-12.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.4.2-13">Upon receiving the signed blinded key, the <code>OD</code> unblinds the signature
and stores it. If the <code>OD</code> generated <code>Y_i</code>, it must also transfer it
to the <code>ACC</code>. Note that <code>ACC</code> does not need a copy of the signature.<a href="#section-5.4.2-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="accessory-in-nearby-owner-mode">
<section id="section-5.4.3">
          <h4 id="name-accessory-in-nearby-owner-m">
<a href="#section-5.4.3" class="section-number selfRef">5.4.3. </a><a href="#name-accessory-in-nearby-owner-m" class="section-name selfRef">Accessory in Nearby Owner Mode</a>
          </h4>
<p id="section-5.4.3-1">After pairing, when the Accessory <code>ACC</code> is in Bluetooth range of <code>OD</code>, it will follow the protocol as decribed in <span>[<a href="#DultDoc3" class="cite xref">DultDoc3</a>]</span>.<a href="#section-5.4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="accessory-in-separated-lost-mode">
<section id="section-5.4.4">
          <h4 id="name-accessory-in-separated-lost">
<a href="#section-5.4.4" class="section-number selfRef">5.4.4. </a><a href="#name-accessory-in-separated-lost" class="section-name selfRef">Accessory in Separated (Lost) Mode</a>
          </h4>
<p id="section-5.4.4-1">After pairing, when the Accessory <code>ACC</code> no longer in the Bluetooth range of <code>OD</code>, it will follow the protocol as decribed below:, which should correspond to the behavior outlined in <span>[<a href="#DultDoc3" class="cite xref">DultDoc3</a>]</span>:<a href="#section-5.4.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4.4-2"><code>ACC</code> periodically sends out an Advertisement which contains the then
current ephemeral public key <code>Y_i</code>. The full payload format of the
Advertisement is defined in <span>[<a href="#DultDoc3" class="cite xref">DultDoc3</a>]</span>.<a href="#section-5.4.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="finder-device-creates-a-location-report">
<section id="section-5.5">
        <h3 id="name-finder-device-creates-a-loc">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-finder-device-creates-a-loc" class="section-name selfRef">Finder Device creates a Location Report</a>
        </h3>
<p id="section-5.5-1">The Finder Device <code>FD</code> receives the advertisement via Bluetooth. <code>FD</code> should have a mechanism by which to authenticate that this is a valid public key with <code>CN</code>. *<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">In order to report an accessory's location at time <code>i</code>, <code>FD</code> extracts the elliptic curve public key from the advertisement, and records it own location data, a timestamp, and a confidence value as described in <span>[<a href="#Heinrich" class="cite xref">Heinrich</a>]</span>.<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<p id="section-5.5-3"><code>FD</code> performs ECDH with the public key  <code>Y</code><sub>i</sub> and uses it to encrypt the
location data using HPKE Seal <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>. It sends the result to the CN along with
the hash of the current public key and the current time.
[[OPEN ISSUE: Should we work in terms of hashes or the public
keys. What we send has to be what's looked up.]]. <code>CN</code> stores the resulting
values indexed under the hash of the public key.<a href="#section-5.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="owner-device-queries-the-crowdsourced-network">
<section id="section-5.6">
        <h3 id="name-owner-device-queries-the-cr">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-owner-device-queries-the-cr" class="section-name selfRef">Owner Device queries the Crowdsourced Network</a>
        </h3>
<p id="section-5.6-1"><code>OD</code>s can retrieve the location of a paired <code>ACC</code> by querying the <code>CN</code>.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<p id="section-5.6-2">In order to query for a given time period <code>i</code> it presents:<a href="#section-5.6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6-3.1">
            <p id="section-5.6-3.1.1">The public key <code>Y_i</code> [or hash of the public key]<a href="#section-5.6-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.6-3.2">
            <p id="section-5.6-3.2.1">The <code>CN</code>'s signature over <code>Y_i</code> as well as the associated
<code>info</code> value.<a href="#section-5.6-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.6-4">The CN then proceeds as follows:<a href="#section-5.6-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.6-5">
<li id="section-5.6-5.1">
            <p id="section-5.6-5.1.1">Verify the signature over the key [hash]<a href="#section-5.6-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.6-5.2">
            <p id="section-5.6-5.2.1">Verify that the timestamp in the <code>info</code> value is within an
acceptable period of time (e.g., one week) from the current time
[[OPEN ISSUE: Why do we need this step?]]<a href="#section-5.6-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.6-5.3">
            <p id="section-5.6-5.3.1">Retrieve all reports matching the provided <code>Y_i</code><a href="#section-5.6-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.6-5.4">
            <p id="section-5.6-5.4.1">Remove all reports which have timestamps that are not within the acceptable
time use window for the key, as indicated by the key's timestamp.<a href="#section-5.6-5.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.6-5.5">
            <p id="section-5.6-5.5.1">Return the remaining reports to <code>OD</code>.<a href="#section-5.6-5.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-5.6-6">Finally, <code>OD</code> uses HPKE Open to decrypt the resulting reports,
thus recovering the location data for report.<a href="#section-5.6-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">TODO Security - as described in <span>[<a href="#DultDoc4" class="cite xref">DultDoc4</a>]</span>?.
This section still mostly needs to be written.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="effectiveness-of-rate-limiting-via-blind-signatures">
<section id="section-6.1">
        <h3 id="name-effectiveness-of-rate-limit">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-effectiveness-of-rate-limit" class="section-name selfRef">Effectiveness of Rate Limiting via Blind Signatures</a>
        </h3>
<p id="section-6.1-1">The blind signature mechanism described here (adapted from
<span>[<a href="#BlindMy" class="cite xref">BlindMy</a>]</span>) helps to limit the damage of noncompliant devices.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Because the <code>CN</code> will only generate signatures when the request is
associated with a valid device, an attacker cannot obtain a key
directly for a noncompliant device. However, this does not necessarily
mean that the attacker cannot provision noncompliant
devices. Specifically, if the <code>OD</code> sees the public keys (it need not
know the private keys, as described below) when they are sent to the
<code>CN</code> for signature, then it can provision them to a noncompliant
device.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">Even an attacker who can provision invalid devices can only obtain one
key per time window per valid device. Because key use windows overlap,
it is possible to rotate keys more frequently than the window, but in
order to rotate keys significantly more frequently than this, the
attacker must purchase multiple devices. However, they may be able
to provision the keys from multiple valid devices onto the same device,
thus achieving a rotation rate increase at linear cost.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">Note that enforcement of this rate limit happens only on the <code>CN</code>: the
<code>FD</code> does not check. An attacker can generate advertisements with
unsigned keys -- and thus at any rotation rate it chooses -- and the
<code>FD</code> will duly send valid reports encrypted under those keys. The <code>CN</code>
will store them but because the attacker will not be able to produce
valid signatures, they will not be able to retrieve those reports.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">As noted above, the <code>ACC</code> does not need to prove that it knows the
corresponding private keys for a given public key. The <code>ACC</code>
simply broadcasts the public keys; it is the <code>OD</code> which needs to
know the private keys in order to decrypt the reports.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-7">
      <h2 id="name-privacy-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-7-1">TODO Privacy - as described in <span>[<a href="#DultDoc4" class="cite xref">DultDoc4</a>]</span>?<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document has no IANA actions.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.detecting-unwanted-location-trackers">[I-D.detecting-unwanted-location-trackers]</dt>
        <dd>
<span class="refAuthor">Ledvina, B.</span>, <span class="refAuthor">Eddinger, Z.</span>, <span class="refAuthor">Detwiler, B.</span>, and <span class="refAuthor">S. P. Polatkan</span>, <span class="refTitle">"Detecting Unwanted Location Trackers"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-detecting-unwanted-location-trackers-01</span>, <time datetime="2023-12-20" class="refDate">20 December 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-detecting-unwanted-location-trackers-01">https://datatracker.ietf.org/doc/html/draft-detecting-unwanted-location-trackers-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9180">[RFC9180]</dt>
      <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Lipp, B.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Hybrid Public Key Encryption"</span>, <span class="seriesInfo">RFC 9180</span>, <span class="seriesInfo">DOI 10.17487/RFC9180</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9180">https://www.rfc-editor.org/rfc/rfc9180</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Beck">[Beck]</dt>
        <dd>
<span class="refAuthor">Gabrielle Beck</span>, <span class="refAuthor">Harry Eldridge</span>, <span class="refAuthor">Matthew Green</span>, <span class="refAuthor">Nadia Heninger</span>, and <span class="refAuthor">Abishek Jain</span>, <span class="refTitle">"Abuse-Resistant Location Tracking: Balancing Privacy and Safety in the Offline Finding Ecosystem"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://eprint.iacr.org/2023/1332.pdf">https://eprint.iacr.org/2023/1332.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BlindMy">[BlindMy]</dt>
        <dd>
<span class="refAuthor">Travis Mayberry</span>, <span class="refAuthor">Erik-Oliver Blass</span>, and <span class="refAuthor">Ellis Fenske</span>, <span class="refTitle">"Blind My — An Improved Cryptographic Protocol to Prevent Stalking in Apple’s Find My Network"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://petsymposium.org/popets/2023/popets-2023-0006.pdf">https://petsymposium.org/popets/2023/popets-2023-0006.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DultDoc3">[DultDoc3]</dt>
        <dd>
<span class="refAuthor">Brent Ledvina</span>, <span class="refAuthor">Lazarov, D.</span>, <span class="refAuthor">Detwiler, B.</span>, and <span class="refAuthor">S. P. Polatkan</span>, <span class="refTitle">"Detecting Unwanted Location Trackers Accessory Protocol"</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ledvina-dult-accessory-protocol-00.html">https://www.ietf.org/archive/id/draft-ledvina-dult-accessory-protocol-00.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DultDoc4">[DultDoc4]</dt>
        <dd>
<span class="refAuthor">Maggie Delano</span> and <span class="refAuthor">Jessie Lowell</span>, <span class="refTitle">"DRAFT Dult Threat Model"</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-delano-dult-threat-model">https://datatracker.ietf.org/doc/html/draft-delano-dult-threat-model</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GMCKV21">[GMCKV21]</dt>
        <dd>
<span class="refAuthor">Chinmay Garg</span>, <span class="refAuthor">Aravind Machiry</span>, <span class="refAuthor">Andrea Continella</span>, <span class="refAuthor">Christopher Kruegel</span>, and <span class="refAuthor">Giovanni Vigna</span>, <span class="refTitle">"Toward a secure crowdsourced location tracking system"</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/3448300.3467821">https://dl.acm.org/doi/10.1145/3448300.3467821</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Heinrich">[Heinrich]</dt>
        <dd>
<span class="refAuthor">Alexander Heinrich</span>, <span class="refAuthor">Milan Stute</span>, <span class="refAuthor">Tim Kornhuber</span>, and <span class="refAuthor">Matthias Hollick</span>, <span class="refTitle">"Who Can Find My Devices? Security and Privacy of Apple's Crowd-Sourced Bluetooth Location Tracking System"</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://petsymposium.org/popets/2021/popets-2021-0045.pdf">https://petsymposium.org/popets/2021/popets-2021-0045.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9298">[RFC9298]</dt>
        <dd>
<span class="refAuthor">Schinazi, D.</span>, <span class="refTitle">"Proxying UDP in HTTP"</span>, <span class="seriesInfo">RFC 9298</span>, <span class="seriesInfo">DOI 10.17487/RFC9298</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9298">https://www.rfc-editor.org/rfc/rfc9298</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9458">[RFC9458]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span> and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Oblivious HTTP"</span>, <span class="seriesInfo">RFC 9458</span>, <span class="seriesInfo">DOI 10.17487/RFC9458</span>, <time datetime="2024-01" class="refDate">January 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9458">https://www.rfc-editor.org/rfc/rfc9458</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9474">[RFC9474]</dt>
        <dd>
<span class="refAuthor">Denis, F.</span>, <span class="refAuthor">Jacobs, F.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"RSA Blind Signatures"</span>, <span class="seriesInfo">RFC 9474</span>, <span class="seriesInfo">DOI 10.17487/RFC9474</span>, <time datetime="2023-10" class="refDate">October 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9474">https://www.rfc-editor.org/rfc/rfc9474</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Samsung">[Samsung]</dt>
        <dd>
<span class="refAuthor">Tingfeng Yu</span>, <span class="refAuthor">James Henderson</span>, <span class="refAuthor">Alwen Tiu</span>, and <span class="refAuthor">Thomas Haines</span>, <span class="refTitle">"Privacy Analysis of Samsung’s Crowd-Sourced Bluetooth Location Tracking System"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://www.usenix.org/system/files/sec23winter-prepub-498-yu.pdf">https://www.usenix.org/system/files/sec23winter-prepub-498-yu.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WhoTracks">[WhoTracks]</dt>
      <dd>
<span class="refAuthor">Travis Mayberry</span>, <span class="refAuthor">Ellis Fenske</span>, <span class="refAuthor">Dane Brown</span>, <span class="refAuthor">Christine Fossaceca</span>, <span class="refAuthor">Sam Teplov</span>, <span class="refAuthor">Lucas Foppe</span>, <span class="refAuthor">Jeremey Martin</span>, and <span class="refAuthor">Erik Rye</span>, <span class="refTitle">"Who Tracks the Trackers?"</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/3463676.3485616">https://dl.acm.org/doi/10.1145/3463676.3485616</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO acknowledge.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christine Fossaceca</span></div>
<div dir="auto" class="left"><span class="org">Microsoft</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:cfossaceca@microsoft.com" class="email">cfossaceca@microsoft.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Eric Rescorla</span></div>
<div dir="auto" class="left"><span class="org">Windy Hill Systems, LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ekr@rtfm.com" class="email">ekr@rtfm.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>

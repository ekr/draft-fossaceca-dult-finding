<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Greek,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Finding Tracking Tags</title>
<meta content="Christine Fossaceca" name="author">
<meta content="Eric Rescorla" name="author">
<meta content="
       Lightweight location tracking tags are in wide use to allow users
to locate items. These tags function as a component of a crowdsourced
tracking network in which devices belonging to other network
users (e.g., phones) report which
tags they see and their location, thus allowing the owner of the
tag to determine where their tag was most recently seen. This
document defines the protocol by which devices report tags
they have seen and by which owners look up their location. 
    " name="description">
<meta content="xml2rfc 3.22.0" name="generator">
<meta content="draft-fossaceca-dult-finding-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.22.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 69.5.1
    wcwidth 0.2.13
-->
<link href="draft-fossaceca-dult-finding.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Finding Tracking Tags</td>
<td class="right">July 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Fossaceca &amp; Rescorla</td>
<td class="center">Expires 9 January 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Detecting Unwanted Location Trackers</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-fossaceca-dult-finding-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-07-08" class="published">8 July 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-01-09">9 January 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Fossaceca</div>
<div class="org">Microsoft</div>
</div>
<div class="author">
      <div class="author-name">E. Rescorla</div>
<div class="org">Windy Hill Systems, LLC</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Finding Tracking Tags</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Lightweight location tracking tags are in wide use to allow users
to locate items. These tags function as a component of a crowdsourced
tracking network in which devices belonging to other network
users (e.g., phones) report which
tags they see and their location, thus allowing the owner of the
tag to determine where their tag was most recently seen. This
document defines the protocol by which devices report tags
they have seen and by which owners look up their location.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://ekr.github.io/draft-fossaceca-dult-finding/draft-fossaceca-dult-finding.html">https://ekr.github.io/draft-fossaceca-dult-finding/draft-fossaceca-dult-finding.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-fossaceca-dult-finding/">https://datatracker.ietf.org/doc/draft-fossaceca-dult-finding/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Detecting Unwanted Location Trackers Working Group mailing list (<span><a href="mailto:unwanted-trackers@ietf.org">mailto:unwanted-trackers@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/unwanted-trackers/">https://mailarchive.ietf.org/arch/browse/unwanted-trackers/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/unwanted-trackers/">https://www.ietf.org/mailman/listinfo/unwanted-trackers/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/ekr/draft-fossaceca-dult-finding">https://github.com/ekr/draft-fossaceca-dult-finding</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 9 January 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-motivations" class="internal xref">Motivations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-stalking-prevention" class="internal xref">Stalking Prevention</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-existing-protocols" class="internal xref">Existing Protocols</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-high-level-protocol" class="internal xref">High Level Protocol</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-general-protocol-infrastruc" class="internal xref">General Protocol Infrastructure Properties</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-partial-blind-signature-sch" class="internal xref">Partial Blind Signature Scheme</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-initial-pairing-accessory-s" class="internal xref">Initial Pairing / Accessory Setup</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="auto internal xref">4.4.1</a>.  <a href="#name-authenticity-verification" class="internal xref">Authenticity Verification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="auto internal xref">4.4.2</a>.  <a href="#name-key-generation-and-signing-" class="internal xref">Key Generation and Signing with Partial Blind Signatures</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-accessory-behavior" class="internal xref">Accessory Behavior</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a href="#section-4.5.1" class="auto internal xref">4.5.1</a>.  <a href="#name-accessory-in-nearby-owner-m" class="internal xref">Accessory in Nearby Owner Mode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.2">
                    <p id="section-toc.1-1.4.2.5.2.2.1"><a href="#section-4.5.2" class="auto internal xref">4.5.2</a>.  <a href="#name-accessory-in-separated-lost" class="internal xref">Accessory in Separated (Lost) Mode</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-finder-device-creates-a-loc" class="internal xref">Finder Device creates a Location Report</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-owner-device-queries-the-cr" class="internal xref">Owner Device queries the Crowdsourced Network</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="auto internal xref">4.8</a>.  <a href="#name-reporting-device-leakage" class="internal xref">Reporting Device Leakage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a href="#section-4.9" class="auto internal xref">4.9</a>.  <a href="#name-non-compliant-accessories" class="internal xref">Non-compliant Accessories</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">DISCLAIMER: This draft is work-in-progress and has not yet seen significant (or
really any) security analysis. It should not be used as a basis for building
production systems. This published version of the draft has been designated
an "implementation draft" for testing and interop purposes.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Lightweight location tracking tags are a mechanism by which users can track their personal items. These tags function as a component of a crowdsourced
tracking network in which devices belonging to other network users
(e.g., phones) report on the location of tags they have seen.
At a high level, this works as follows:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">
          <p id="section-1-3.1.1">Tags ("Accessories") broadcast an advertisement payload containing
accessory-specific information. The payload also indicates whether
the accessory is separated from its owner and thus potentially lost.<a href="#section-1-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.2">
          <p id="section-1-3.2.1">Devices belonging to other users ("Non-Owner Devices" or "Finder Devices")
observe those payloads and if the payload is in a separated
mode, reports its location to some central service ("crowdsourced network").<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.3">
          <p id="section-1-3.3.1">The owner ("Owner Device") queries the central service ("crowdsourced network") for the location of their
accessory.<a href="#section-1-3.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-4">A naive implementation of this design exposes users to considerable
privacy risk. In particular:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-5.1">
          <p id="section-1-5.1.1">If accessories simply have a fixed identifier that is reported back
to the tracking network, then the central server is able to track
any accessory without the user's assistance, which is clearly
undesirable.<a href="#section-1-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.2">
          <p id="section-1-5.2.1">Any attacker who can guess a tag ID can query the central server
for its location.<a href="#section-1-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.3">
          <p id="section-1-5.3.1">An attacker can surreptitiously plant an accessory on a target
and thus track them by tracking their "own" accessory.<a href="#section-1-5.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-6"><a href="#security-considerations" class="auto internal xref">Section 5</a> provides more detailed definition of the
desired security privacy properties, but briefly, we would like to
have a system in which:<a href="#section-1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-7.1">
          <p id="section-1-7.1.1">Nobody other than the owner of an accessory would be able to learn
anything about the location of a given accessory.<a href="#section-1-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-7.2">
          <p id="section-1-7.2.1">It is possible to detect when an accessory is being used to track you.<a href="#section-1-7.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-7.3">
          <p id="section-1-7.3.1">It is not possible for accessories that do not adhere to the protocol to use the crowdsourced network protocol.<a href="#section-1-7.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-7.4">
          <p id="section-1-7.4.1">It is not possible for unverified accessories to use the crowdsourced network protocol.<a href="#section-1-7.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-8">This document defines a cryptographic reporting and finding protocol
which is intended to minimize these privacy risks. It is intended
to work in concert with the requirements defined in
<span>[<a href="#I-D.detecting-unwanted-location-trackers" class="cite xref">I-D.detecting-unwanted-location-trackers</a>]</span>, which facilitate
detection of unwanted tracking tags. This protocol design is based on existing academic research surrounding the security and privacy of bluetooth location tracking accessories on the market today, as described in <span>[<a href="#BlindMy" class="cite xref">BlindMy</a>]</span> and <span>[<a href="#GMCKV21" class="cite xref">GMCKV21</a>]</span>.<a href="#section-1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="motivations">
<section id="section-2">
      <h2 id="name-motivations">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-motivations" class="section-name selfRef">Motivations</a>
      </h2>
<div id="stalking-prevention">
<section id="section-2.1">
        <h3 id="name-stalking-prevention">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-stalking-prevention" class="section-name selfRef">Stalking Prevention</a>
        </h3>
<p id="section-2.1-1">This work has been inspired by the negative security and privacy implications that were introduced by lightweight location tracking tags, and defined in part by <span>[<a href="#I-D.detecting-unwanted-location-trackers" class="cite xref">I-D.detecting-unwanted-location-trackers</a>]</span>. The full threat model is described in detail in <span>[<a href="#DultDoc4" class="cite xref">DultDoc4</a>]</span>, however, a significant element of the threat model lies in part with the security of the Crowdsourced Network, which will be discussed in detail here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The Crowdsourced Network has unwittingly provided stalkers with a means to anonymously upload and download location reports from BLE trackers. Thus, this document outlines the requirements and responsibilities of the Crowdsourced Network to verify the authenticity of the participants, while also preserving user privacy.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-3.1">
            <p id="section-2.1-3.1.1">First, the Crowdsourced Network has a responsibility to ensure that only authentic Finding Devices are sending reports to the Crowdsourced Network, and this should occur via an authenticated and encrypted channel. This will help prevent malicious actors from interfering with location reporting services.<a href="#section-2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.2">
            <p id="section-2.1-3.2.1">Second, the Crowdsourced Network has a responsibility to ensure that only authorized Owner Devices are able to download location reports, and this should occur via an authenticated and encrypted channel. This will prevent malicious actors from unauthorized access of location data.<a href="#section-2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.3">
            <p id="section-2.1-3.3.1">Third, the Crowdsourced Network must follow basic security principles, such as<a href="#section-2.1-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-3.3.2.1">
                <p id="section-2.1-3.3.2.1.1">Storing location reports in an encrypted manner<a href="#section-2.1-3.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-3.3.2.2">
                <p id="section-2.1-3.3.2.2.1">Limiting location report data storage to 7 days or less<a href="#section-2.1-3.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.1-3.3.3">
<em>(The benefits of this requirement are self explanatory.)</em><a href="#section-2.1-3.3.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.4">
            <p id="section-2.1-3.4.1">Fourth, the Crowdsourced Network must validate that the accessory registered to an owner is valid.  This wil prevent malicious actors from leveraging counterfeit accessories.<a href="#section-2.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.5">
            <p id="section-2.1-3.5.1">Fifth, users should should be able to opt-out of their devices participating in the Crowdsourced Network.<a href="#section-2.1-3.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="existing-protocols">
<section id="section-2.2">
        <h3 id="name-existing-protocols">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-existing-protocols" class="section-name selfRef">Existing Protocols</a>
        </h3>
<p id="section-2.2-1">There are a variety of different products on the market today that leverage a Crowdsourced Network for location tracking. Currently, each manufacturer has designed its own implementation and product.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">These include:<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-3.1">
            <p id="section-2.2-3.1.1">Apple and the AirTag, as described in <span>[<a href="#WhoTracks" class="cite xref">WhoTracks</a>]</span> and <span>[<a href="#Heinrich" class="cite xref">Heinrich</a>]</span><a href="#section-2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-3.2">
            <p id="section-2.2-3.2.1">Samsung and the SmartTag, as described in <span>[<a href="#Samsung" class="cite xref">Samsung</a>]</span><a href="#section-2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-3.3">
            <p id="section-2.2-3.3.1">Tile, CUBE, Chipolo, Pebblebee and TrackR as described in <span>[<a href="#GMCKV21" class="cite xref">GMCKV21</a>]</span><a href="#section-2.2-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-3">
      <h2 id="name-conventions-and-definitions">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-3-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Section 1.2 of <span>[<a href="#I-D.detecting-unwanted-location-trackers" class="cite xref">I-D.detecting-unwanted-location-trackers</a>]</span> provides
definitions of the various system components.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Accessory (ACC): This is the device which will be tracked. It is assumed to lack direct internet access and GPS, but will possess Bluetooth Low Energy capabilities, which it uses to send advertisement messages. The accessory protocol is defined in <span>[<a href="#DultDoc3" class="cite xref">DultDoc3</a>]</span>.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Advertisement: This is the message that is sent over the BLE Protocol from the Accessory<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">Crowdsourced Network (CN): This is the network that provides the location reporting upload and download services for Owner Devices and Dinder Devices.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">Finder Device (FD): This is a device that is a non-owner device that contributes information about an accessory to the crowdsourced network.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">Owner Device (OD): This is the device which owns the accessory, and to which it is paired. There can be multiple owner devices, however, the security of that implementation is outside of the scope of this document.<a href="#section-3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol-overview">
<section id="section-4">
      <h2 id="name-protocol-overview">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<div id="high-level-protocol">
<section id="section-4.1">
        <h3 id="name-high-level-protocol">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-high-level-protocol" class="section-name selfRef">High Level Protocol</a>
        </h3>
<p id="section-4.1-1"><a href="#fig-protocol-overview" class="auto internal xref">Figure 1</a> provides an overall view of the protocol.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">In this protocol, the Accessory communicates to Finder Devices or <code>FDs</code>(such as phones) solely via Bluetooth, and the <code>FDs</code> communicate to a centralized service on the Crowdsourced Network <code>CN</code>. Only during the setup phase is the Owner Device <code>OD</code> able to act as a relay between the Accessory <code>ACC</code> and the Crowdsourced Network <code>CN</code>. In this implementation, the <code>CN</code> is able to act as a verifier and signer by leveraging Blind Signatures, which allows the <code>OD</code> to obtain a signature from the signer <code>CN</code> without revealing the input to the <code>CN</code>.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<span id="name-protocol-overview-2"></span><div id="fig-protocol-overview">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-4.1-3.1">
<pre>
                              ╭――――――――――――――――――╮
                              │        o         │
                              │ ╭──────────────╮ │
                              │ │              │ │
                              │ │              │ │                        .-~~~-.
                              │ │              │ │                .- ~ ~-(       )_ _
    o  o                      │ │              │ │               /                     ~ -.
 o        o                   │ │              │ │              |                           \
o          o     -------&gt;     │ │              │ │   -------&gt;    \                         .'
o          o                  │ │              │ │                 ~- . _____________ . -~
 o        o                   │ │              │ │
    o  o                      │ │              │ │
                              │ │              │ │
                              │ ╰──────────────╯ │
                              │       (_)        │
                              ╰――――――――――――――――――╯



  Accessory         BLE           Finder Device      Location            CN Server
               Advertisement                          Upload



</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-protocol-overview-2" class="selfRef">Protocol Overview</a>
          </figcaption></figure>
</div>
<p id="section-4.1-4">In this implementation, there are 4 stages that will be outlined, taking into account elements from both <span>[<a href="#BlindMy" class="cite xref">BlindMy</a>]</span> and <span>[<a href="#GMCKV21" class="cite xref">GMCKV21</a>]</span>.  These stages are as follows:<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">1) <strong>Initial Pairing / Accessory Setup</strong><a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">In this phase, the Accessory <code>ACC</code> is paired with the Owner Device <code>OD</code>, and verified as authentic with the Crowdsourced Network <code>CN</code><a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">2) <strong>Accessory in Nearby Owner Mode</strong><a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">In this phase, the Accessory <code>ACC</code> is within Bluetooth range of the Owner Device <code>OD</code>. In this phase, Finder Devices <code>FDs</code> <span class="bcp14">SHALL NOT</span> generate location reports to send to the Crownsourced Network <code>CN</code>. The Accessory <span class="bcp14">SHALL</span> behave as defined in <span>[<a href="#DultDoc3" class="cite xref">DultDoc3</a>]</span>.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1-9">3) <strong>Accessory in Separated (Lost) Mode</strong><a href="#section-4.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1-10">In this phase, the Accessory <code>ACC</code> is not within Bluetooth raange fo the Owner Device <code>OD</code>, therefore, the accessory must generate "lost" messages to be received by Finder Devices <code>FD</code>, as described in <span>[<a href="#DultDoc3" class="cite xref">DultDoc3</a>]</span>.<a href="#section-4.1-10" class="pilcrow">¶</a></p>
<p id="section-4.1-11">4) <strong>Finder Device creates a location report</strong><a href="#section-4.1-11" class="pilcrow">¶</a></p>
<p id="section-4.1-12">Finder Device <code>FD</code> receives a Bluetooth packet, and uploads a location report to the Crowdsourced Network <code>CN</code> if and only if it is confirmed to be a valid location report.<a href="#section-4.1-12" class="pilcrow">¶</a></p>
<p id="section-4.1-13">*(Should this be confirmed by the FD, or the CN? or Both?)<a href="#section-4.1-13" class="pilcrow">¶</a></p>
<p id="section-4.1-14">5) <strong>Owner Device queries the Crowdsourced Network</strong><a href="#section-4.1-14" class="pilcrow">¶</a></p>
<p id="section-4.1-15">Owner Device <code>OD</code> queries the Crowdsourced Network <code>CN</code> for the encrypted location report.<a href="#section-4.1-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="general-protocol-infrastructure-properties">
<section id="section-4.2">
        <h3 id="name-general-protocol-infrastruc">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-general-protocol-infrastruc" class="section-name selfRef">General Protocol Infrastructure Properties</a>
        </h3>
<p id="section-4.2-1">Relying on <span>[<a href="#BlindMy" class="cite xref">BlindMy</a>]</span>, we define the following constraints:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1">
            <p id="section-4.2-2.1.1">There exists an agreed upon elliptic curve group with a generator,
a secure Message Authentication Algorithm, and a hashing
function <em>H</em>.<a href="#section-4.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.2">
            <p id="section-4.2-2.2.1"><code>CN</code> knows a key pair <code>(K</code><sub>S</sub>,<code>P</code><sub>S</sub><code>)</code>, where the public key
<code>P</code><sub>S</sub> is known to all participants.<a href="#section-4.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.3">
            <p id="section-4.2-2.3.1"><code>CN</code> has a private symmetric encryption key K<sub>SERIAL</sub>.<a href="#section-4.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.4">
            <p id="section-4.2-2.4.1"><code>CN</code> maintains a database of registered serial values D<sub>SERIAL</sub><a href="#section-4.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.5">
            <p id="section-4.2-2.5.1">Each Accessory <code>ACC</code><sub>i</sub> contains a unique serial number and tag (<code>Serial</code><sub>i</sub>, <code>T</code><sub>i</sub>)<a href="#section-4.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.6">
            <p id="section-4.2-2.6.1">All parties have a synchronized clock and the ability to represent the current day (or another arbitrary timestamp) as an integer<a href="#section-4.2-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.7">
            <p id="section-4.2-2.7.1">A parameter <em>N</em> is defined by the protocol that represents the number of encryption keys produced during the pairing algorithm.<a href="#section-4.2-2.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="partial-blind-signature-scheme">
<section id="section-4.3">
        <h3 id="name-partial-blind-signature-sch">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-partial-blind-signature-sch" class="section-name selfRef">Partial Blind Signature Scheme</a>
        </h3>
<p id="section-4.3-1">In order to verify the parties involved in the protocol, we rely on a partial blind signature scheme as defined in <span>[<a href="#BlindMy" class="cite xref">BlindMy</a>]</span> and <span>[<a href="#Okamoto" class="cite xref">Okamoto</a>]</span>:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">Partial Blind Signature Scheme</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">* There exists a probabilistic polynomial time (PPT) algorithm called <em>KeyGen</em> that takes a security parameter as input and outputs a key pair containing a secret key and public key (<code>s</code><sub>k</sub>,<code>p</code><sub>k</sub>).</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">* There exists two interactive PPT algorithms called <em>Signer</em> and <em>User</em> that compute a signature <code>σ</code> of a message <code>m</code> and plaintext auxiliary information <code>info</code>. The <em>Signer</em> begins with (<code>s</code><sub>k</sub>,<code>p</code><sub>k</sub>,<code>info</code>), and the <em>User</em> starts with (<code>p</code><sub>k</sub>,<code>info</code>, <code>m</code>). After interacting, the <em>User</em> outputs (<code>m</code>, <code>σ</code> ) if the protocol succeeds and    <code>⊥</code> if it fails.</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">* There exists a PPT algorithm called <em>Verify</em> that receives  (<code>p</code><sub>k</sub>,<code>info</code>, <code>m</code>,<code>σ</code> ) and outputs <code>accept</code> when the signature is valid, and <code>reject</code> if it is not.</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="initial-pairing-accessory-setup">
<section id="section-4.4">
        <h3 id="name-initial-pairing-accessory-s">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-initial-pairing-accessory-s" class="section-name selfRef">Initial Pairing / Accessory Setup</a>
        </h3>
<p id="section-4.4-1">During the pairing process, the Accessory <code>ACC</code> pairs with the Owner Device <code>OD</code> over Bluetooth. In this process, the <code>ACC</code> and <code>OD</code> must generate cryptographically secure keys that will allow for the <code>OD</code> to decrypt the <code>ACC</code> location reports.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<div id="authenticity-verification">
<section id="section-4.4.1">
          <h4 id="name-authenticity-verification">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-authenticity-verification" class="section-name selfRef">Authenticity Verification</a>
          </h4>
<p id="section-4.4.1-1">Upon the initial pairing of the the <code>ACC</code> and <code>OD</code>, before the key generation process, the <code>OD</code> must facilitate communication with the <code>CN</code> to verify the authenticity of the <code>ACC</code>. In <span>[<a href="#GMCKV21" class="cite xref">GMCKV21</a>]</span>, it is recommended that the <code>ACC</code> has a private key material fused into the chip at manufacture time.<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.1-2">In <span>[<a href="#BlindMy" class="cite xref">BlindMy</a>]</span>, the principal of <em>Serial Unforgeability</em> is introduced, which recommends that the serial numbers are assigned as an unforgeable MAC that is computed with a secret key only known to the server.<a href="#section-4.4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.4.1-3">(1)<code>OD</code> extracts the values (<code>Serial</code><sub>i</sub>, <code>T</code><sub>i</sub>) from <code>ACC</code>, where<a href="#section-4.4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.4.1-4"><code>T</code><sub>i</sub> = MAC<sub>KSERIAL</sub>(<code>Serial</code><sub>i</sub>)<a href="#section-4.4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.4.1-5">(2) <code>OD</code> transmits these values to <code>CN</code>.<a href="#section-4.4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.4.1-6">(3) <code>CN</code> independently verifies <code>T</code><sub>i</sub><a href="#section-4.4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.4.1-7">(4) To prevent re-enrollment of a tag, <code>CN</code> also checks <code>Serial</code><sub>i</sub> ∉ <code>D</code><sub>SERIAL</sub><a href="#section-4.4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.4.1-8">(5) If (3) or (4) fails, <code>CN</code> aborts. Otherwise, <code>CN</code> adds <code>Serial</code><sub>i</sub> to <code>D</code><sub>SERIAL</sub><a href="#section-4.4.1-8" class="pilcrow">¶</a></p>
<p id="section-4.4.1-9">(6) <code>CN</code> sends public parameters for generating <em>N</em> partial blind signatures to <code>OD</code>. These parameters are defined in the next section.<a href="#section-4.4.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-generation-and-signing-with-partial-blind-signatures">
<section id="section-4.4.2">
          <h4 id="name-key-generation-and-signing-">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-key-generation-and-signing-" class="section-name selfRef">Key Generation and Signing with Partial Blind Signatures</a>
          </h4>
<p id="section-4.4.2-1">In order for <code>OD</code> to have <em>N</em> keys signed by partial blind signatures, the scheme described in <span>[<a href="#BlindMy" class="cite xref">BlindMy</a>]</span> must be implemented.<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2-2">For convenience, it is summarized below:<a href="#section-4.4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.4.2-3">(1) <code>CN</code> generates the public parameters <code>u, d, s, a, b</code> where <code>u, d, s</code> represent the Signer State and <code>a, b</code> represents the Signature Parameters.<a href="#section-4.4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.4.2-4">They are generated by the following code given in <span>[<a href="#BlindMy" class="cite xref">BlindMy</a>]</span> <em>pbs_dh.py</em>:<a href="#section-4.4.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.2-5">
<pre>
def raw_signer_gen_params(hashfunc, privkey, info):
    u = randbelow(q)
    d = randbelow(q)
    s = randbelow(q)

    z = hashToPoint(info, hashfunc)
    a = pow(g, u, p)
    b = (pow(g,s,p) * pow(z,d,p)) % p

    return (u, d, s, a, b)
</pre><a href="#section-4.4.2-5" class="pilcrow">¶</a>
</div>
<p id="section-4.4.2-6">(2) After receiving the public parameters required from <code>CN</code>, <code>OD</code> generates N elliptic-curve keypairs, as shown in the code from <span>[<a href="#BlindMy" class="cite xref">BlindMy</a>]</span> <em>client.py</em>:<a href="#section-4.4.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.2-7">
<pre>
def gen_keys(privateseed: str, numkeys: int) -&gt; List[str]:
    print(f"Generating {numkeys} keys")
    pubkeys = []
    for i in tqdm(range(numkeys)):
        pkey = hashToInt(privateseed + str(i), P224, sha256)
        pubkey = pkey * P224.G
        pubkeyx = '{:056x}'.format(pubkey.x)
        pubkeys.append(pubkeyx)
    return pubkeys
</pre><a href="#section-4.4.2-7" class="pilcrow">¶</a>
</div>
<p id="section-4.4.2-8">(3) <code>OD</code> generates signing requests for each public key in <em>N</em>,using params <em>a</em> and <em>b</em>, the hashing function <em>H</em>, and the auxiliary info for each signing request set as the integer representation of the current day and the <em>N − 1</em> following days. These requests are then sent to <code>CN</code>. Notice that <code>OD</code> performs blinding on each public key before making the request.<a href="#section-4.4.2-8" class="pilcrow">¶</a></p>
<p id="section-4.4.2-9">This is shown in the code from <span>[<a href="#BlindMy" class="cite xref">BlindMy</a>]</span> <em>pbs_dh.py</em>:<a href="#section-4.4.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.2-10">
<pre>
    #sigparams - SignatureParams object, comes from generate_params function above
    #msg - string or bytes object representing the message being signed
    #info - string representing the plaintext auxiliary information to go along with the blinded signature
    def generate_signature_request(self, sigparams, msg, info):
        t1, t2, t3, t4, e = raw_user_blind(self.hashfunc, self.pubkey, msg, info, sigparams.a, sigparams.b)
        return UserState(t1, t2, t3, t4), e
</pre><a href="#section-4.4.2-10" class="pilcrow">¶</a>
</div>
<p id="section-4.4.2-11">(4) <code>CN</code> verifies the timestamp infomation and aborts if not in a valid range.<a href="#section-4.4.2-11" class="pilcrow">¶</a></p>
<p id="section-4.4.2-12">(5) <code>CN</code> signs each each public key with a blind signature and sends the <em>N</em> blind signatures to <code>OD</code>.<a href="#section-4.4.2-12" class="pilcrow">¶</a></p>
<p id="section-4.4.2-13">(6) <code>OD</code> unblinds the signatures and stores <em>N</em> pairs of the form <code>(KeyPair, UnblindedSignature)</code> and transfers the <em>N</em> public keys to the accessory <code>ACC</code>, ordered by timestamp.<a href="#section-4.4.2-13" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="accessory-behavior">
<section id="section-4.5">
        <h3 id="name-accessory-behavior">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-accessory-behavior" class="section-name selfRef">Accessory Behavior</a>
        </h3>
<p id="section-4.5-1">As part of the setup phase (described in <span>[<a href="#DultDoc3" class="cite xref">DultDoc3</a>]</span>) the Accessory <code>ACC</code> and
Owner Device <code>OD</code> are paired, establishing a shared key <code>S</code><sub>K</sub>
which is known to both the accessory and the owning device.
The rest of the protocol proceeds as follows:<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<div id="accessory-in-nearby-owner-mode">
<section id="section-4.5.1">
          <h4 id="name-accessory-in-nearby-owner-m">
<a href="#section-4.5.1" class="section-number selfRef">4.5.1. </a><a href="#name-accessory-in-nearby-owner-m" class="section-name selfRef">Accessory in Nearby Owner Mode</a>
          </h4>
<p id="section-4.5.1-1">After pairing, when the Accessory <code>ACC</code> is in Bluetooth range of <code>OD</code>, it will follow the protocol as decribed in <span>[<a href="#DultDoc3" class="cite xref">DultDoc3</a>]</span>.<a href="#section-4.5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="accessory-in-separated-lost-mode">
<section id="section-4.5.2">
          <h4 id="name-accessory-in-separated-lost">
<a href="#section-4.5.2" class="section-number selfRef">4.5.2. </a><a href="#name-accessory-in-separated-lost" class="section-name selfRef">Accessory in Separated (Lost) Mode</a>
          </h4>
<p id="section-4.5.2-1">After pairing, when the Accessory <code>ACC</code> no longer in the Bluetooth range of <code>OD</code>, it will follow the protocol as decribed below:, which should correspond to the behavior outlined in <span>[<a href="#DultDoc3" class="cite xref">DultDoc3</a>]</span>:<a href="#section-4.5.2-1" class="pilcrow">¶</a></p>
<p id="section-4.5.2-2"><code>ACC</code> periodically sends out an Advertisement which contains
an ephemeral public key <code>Y</code><sub>i</sub> where <code>i</code> is the epoch the key is valid
for.  As defined by our protocol, this epoch is a 24 hour period. <code>Y</code><sub>i</sub> and its corresponding private key
<code>X</code><sub>i</sub> are generated in a deterministic fashion from <code>S</code><sub>K</sub> and the epoch
<code>i</code> (conceptually as <code>X</code><sub>i</sub> = <code>PRF</code>(<code>S</code><sub>K</sub>, <code>i</code>)).<a href="#section-4.5.2-2" class="pilcrow">¶</a></p>
<p id="section-4.5.2-3">The full payload format of the Advertisement is defined in <span>[<a href="#DultDoc3" class="cite xref">DultDoc3</a>]</span>.<a href="#section-4.5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="finder-device-creates-a-location-report">
<section id="section-4.6">
        <h3 id="name-finder-device-creates-a-loc">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-finder-device-creates-a-loc" class="section-name selfRef">Finder Device creates a Location Report</a>
        </h3>
<p id="section-4.6-1">The Finder Device <code>FD</code> receives the advertisement via Bluetooth. <code>FD</code> should have a mechanism by which to authenticate that this is a valid public key with <code>CN</code>. *<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">In order to report an accessory's location at time <code>i</code>, <code>FD</code> extracts the elliptic curve public key from the advertisement, and records it own location data, a timestamp, and a confidence value as described in <span>[<a href="#Heinrich" class="cite xref">Heinrich</a>]</span>.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<p id="section-4.6-3"><code>FD</code> performs ECDH with the public key  <code>Y</code><sub>i</sub> and derives a shared symmetric key with ECIES.<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<p id="section-4.6-4">It then encrypts the location data using the symmetric key, and creates a payload as described in <span>[<a href="#Heinrich" class="cite xref">Heinrich</a>]</span> and <span>[<a href="#WhoTracks" class="cite xref">WhoTracks</a>]</span>. It transmits a payload to <code>CN</code> with the encrypted packet
<code>( E(Y</code><sub>i</sub>,<code>location), Y</code><sub>i</sub><code>)</code>.<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<p id="section-4.6-5"><code>FD</code> uploads the encrypted payload, the public ephemeral key, a timestamp, and the hash of the public key to <code>CN</code>, who records it in a key-value store with the key as the hash of the <code>ACC</code> public key.<a href="#section-4.6-5" class="pilcrow">¶</a></p>
<p id="section-4.6-6">* Some ideas include<a href="#section-4.6-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-7.1">
            <p id="section-4.6-7.1.1"><code>FD</code> can request a signature itself of the key - but would it be the same?<a href="#section-4.6-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-7.2">
            <p id="section-4.6-7.2.1"><code>ACC</code> can send the public key and the signature to <code>FD</code> so <code>FD</code> can verify the signature<a href="#section-4.6-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-7.3">
            <p id="section-4.6-7.3.1"><code>CN</code> has the option of discarding the packet if the hash of the public key is unknown, since the server has already signed all of the keys in the past - but is it reasonable to save/store these?<a href="#section-4.6-7.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="owner-device-queries-the-crowdsourced-network">
<section id="section-4.7">
        <h3 id="name-owner-device-queries-the-cr">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-owner-device-queries-the-cr" class="section-name selfRef">Owner Device queries the Crowdsourced Network</a>
        </h3>
<p id="section-4.7-1">Following the sequence described in <span>[<a href="#BlindMy" class="cite xref">BlindMy</a>]</span>, valid <code>OD</code>s can retrieve the location of a paired <code>ACC</code>.  In order to query the location of <code>ACC</code>, the <code>OD</code> can sends a request to the <code>CN</code>. The <code>CN</code> must verify that each location requested has been blind-signed and is within a valid date range This prevents adversaries from storing many old blind-signed keys and rotating them quickly in order to avoid detection.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">This is achieved in the following manner:<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<p id="section-4.7-3">(1) In order to locate an accessory at time <code>i</code>, the <code>OD</code> uses <code>SK</code> to
compute the hash of the desired public key <code>Y</code><sub>i</sub>. The owner <code>OD</code> sends the unblinded, signed public key hashes to <code>CN</code> corresponding to the date range they are interested in retrieving, along with the corresponding info fields for each one.<a href="#section-4.7-3" class="pilcrow">¶</a></p>
<p id="section-4.7-4">(2) <code>CN</code> confirms the auxiliary information on each signature is reasonable (e.g. falls within the last 7 days) and that the signature of each hash verifies correctly.<a href="#section-4.7-4" class="pilcrow">¶</a></p>
<p id="section-4.7-5">(3) <code>CN</code> retrieves any report matching the hashes supplied <code>Y</code><sub>i</sub> and returns them to the <code>OD</code>, including the public key hash, the ephemeral public key, and encrypted payload, minus any reports where the timestamp does not match the correct time period from the info field (this would indicate that they key was being used outside of its intended validity period).<a href="#section-4.7-5" class="pilcrow">¶</a></p>
<p id="section-4.7-6">(4) For each report, <code>OD</code> finds the public key for the report by its hash, and uses the corresponding private key alongside the ephemeral public key included in the report to decrypt the encrypted payload and recover the timestamp, confidence, and location data associated with the report.<a href="#section-4.7-6" class="pilcrow">¶</a></p>
<p id="section-4.7-7">This design provides substantially improved privacy properties
over a naive design:<a href="#section-4.7-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.7-8">
<li id="section-4.7-8.1">
            <p id="section-4.7-8.1.1">Nobody but the owner can learn the reported location of an
accessory because it is encrypted under <code>Y_i</code>. This includes
the central service, which just sees encrypted reports.<a href="#section-4.7-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.7-8.2">
            <p id="section-4.7-8.2.1">It is not possible to correlate the public keys broadcast
across multiple epochs without knowing the shared key <code>SK</code>,
which is only know to the owner. However, an observer who
sees multiple beacons within the same epoch can correlate
them, as they will have the same <code>Y_i</code>. However, fast
rotation also makes it more difficult to detect unwanted
tracking, which relies on multiple observations of the
same identifier over time.<a href="#section-4.7-8.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.7-9">However, there are a number of residual privacy threats, as described below.<a href="#section-4.7-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reporting-device-leakage">
<section id="section-4.8">
        <h3 id="name-reporting-device-leakage">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-reporting-device-leakage" class="section-name selfRef">Reporting Device Leakage</a>
        </h3>
<p id="section-4.8-1">If the central server is able to learn the identity of the device
reporting an accessory or the identity of the owner requesting the location
of an accessory, then it can infer information about that accessory's
behavior. For instance:<a href="#section-4.8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.8-2.1">
            <p id="section-4.8-2.1.1">If device A reports accessories X and Y owned by different users and
they both query for their devices, then the central server
may learn that those users were in the same place, or at least
their accessories were.<a href="#section-4.8-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.8-2.2">
            <p id="section-4.8-2.2.1">If devices A and B both report tag X, then the server learns that
A and B were in the same place.<a href="#section-4.8-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.8-2.3">
            <p id="section-4.8-2.3.1">If the central server is able to learn where a reporting device
is (e.g., by IP address) and then the user queries for that
accessory, then the server can infer information about where
the user was, or at least where they lost the accessory.<a href="#section-4.8-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.8-3">These issues can be mitigated by concealing the identity and/or
IP address of network elements communicating with the central
server using techniques such as Oblivious HTTP <span>[<a href="#RFC9458" class="cite xref">RFC9458</a>]</span> or
MASQUE <span>[<a href="#RFC9298" class="cite xref">RFC9298</a>]</span>.<a href="#section-4.8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="non-compliant-accessories">
<section id="section-4.9">
        <h3 id="name-non-compliant-accessories">
<a href="#section-4.9" class="section-number selfRef">4.9. </a><a href="#name-non-compliant-accessories" class="section-name selfRef">Non-compliant Accessories</a>
        </h3>
<p id="section-4.9-1">The detection mechanisms described in
<span>[<a href="#I-D.detecting-unwanted-location-trackers" class="cite xref">I-D.detecting-unwanted-location-trackers</a>]</span> depend on correct
behavior from the tracker. For instance, <span><a href="https://datatracker.ietf.org/doc/html/draft-detecting-unwanted-location-trackers-01#section-3.5.1" class="relref">Section 3.5.1</a> of [<a href="#I-D.detecting-unwanted-location-trackers" class="cite xref">I-D.detecting-unwanted-location-trackers</a>]</span> requires that
accessories use a rotation period of 24 hours when in
the "separated" state:<a href="#section-4.9-1" class="pilcrow">¶</a></p>
<p id="section-4.9-2">When in a separated state, the accessory <span class="bcp14">SHALL</span> rotate its address
   every 24 hours.  This duration allows a platform's unwanted
   tracking algorithms to detect that the same accessory is in
   proximity for some period of time, when the owner is not in
   physical proximity.<a href="#section-4.9-2" class="pilcrow">¶</a></p>
<p id="section-4.9-3">However, if an attacker were to make their own accessory that was
generated the right beacon messages or modify an existing one, they
could cause it to rotate the MAC address more frequently, thus
evading detection algorithms. The attestation mechanism described
in Section [TODO] is intended to mitigate this attack.<a href="#section-4.9-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-5-1">TODO Security - as described in <span>[<a href="#DultDoc4" class="cite xref">DultDoc4</a>]</span>?<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-6">
      <h2 id="name-privacy-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-6-1">TODO Privacy - as described in <span>[<a href="#DultDoc4" class="cite xref">DultDoc4</a>]</span>?<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document has no IANA actions.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.detecting-unwanted-location-trackers">[I-D.detecting-unwanted-location-trackers]</dt>
        <dd>
<span class="refAuthor">Ledvina, B.</span>, <span class="refAuthor">Eddinger, Z.</span>, <span class="refAuthor">Detwiler, B.</span>, and <span class="refAuthor">S. P. Polatkan</span>, <span class="refTitle">"Detecting Unwanted Location Trackers"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-detecting-unwanted-location-trackers-01</span>, <time datetime="2023-12-20" class="refDate">20 December 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-detecting-unwanted-location-trackers-01">https://datatracker.ietf.org/doc/html/draft-detecting-unwanted-location-trackers-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BlindMy">[BlindMy]</dt>
        <dd>
<span class="refAuthor">Travis Mayberry</span>, <span class="refAuthor">Erik-Oliver Blass</span>, and <span class="refAuthor">Ellis Fenske</span>, <span class="refTitle">"Blind My — An Improved Cryptographic Protocol to Prevent Stalking in Apple’s Find My Network"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://petsymposium.org/popets/2023/popets-2023-0006.pdf">https://petsymposium.org/popets/2023/popets-2023-0006.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DultDoc3">[DultDoc3]</dt>
        <dd>
<span class="refAuthor">Brent Ledvina</span>, <span class="refAuthor">Lazarov, D.</span>, <span class="refAuthor">Detwiler, B.</span>, and <span class="refAuthor">S. P. Polatkan</span>, <span class="refTitle">"Detecting Unwanted Location Trackers Accessory Protocol"</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ledvina-dult-accessory-protocol-00.html">https://www.ietf.org/archive/id/draft-ledvina-dult-accessory-protocol-00.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DultDoc4">[DultDoc4]</dt>
        <dd>
<span class="refAuthor">Maggie Delano</span> and <span class="refAuthor">Jessie Lowell</span>, <span class="refTitle">"DRAFT Dult Threat Model"</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-delano-dult-threat-model">https://datatracker.ietf.org/doc/html/draft-delano-dult-threat-model</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GMCKV21">[GMCKV21]</dt>
        <dd>
<span class="refAuthor">Chinmay Garg</span>, <span class="refAuthor">Aravind Machiry</span>, <span class="refAuthor">Andrea Continella</span>, <span class="refAuthor">Christopher Kruegel</span>, and <span class="refAuthor">Giovanni Vigna</span>, <span class="refTitle">"Toward a secure crowdsourced location tracking system"</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/3448300.3467821">https://dl.acm.org/doi/10.1145/3448300.3467821</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Heinrich">[Heinrich]</dt>
        <dd>
<span class="refAuthor">Alexander Heinrich</span>, <span class="refAuthor">Milan Stute</span>, <span class="refAuthor">Tim Kornhuber</span>, and <span class="refAuthor">Matthias Hollick</span>, <span class="refTitle">"Who Can Find My Devices? Security and Privacy of Apple's Crowd-Sourced Bluetooth Location Tracking System"</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://petsymposium.org/popets/2021/popets-2021-0045.pdf">https://petsymposium.org/popets/2021/popets-2021-0045.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Okamoto">[Okamoto]</dt>
        <dd>
<span class="refAuthor">Tatsuaki Okamoto</span>, <span class="refTitle">"Efficient blind and partially blind signatures without random oracles"</span>, <time datetime="2006" class="refDate">2006</time>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007/11681878_5">https://link.springer.com/chapter/10.1007/11681878_5</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9298">[RFC9298]</dt>
        <dd>
<span class="refAuthor">Schinazi, D.</span>, <span class="refTitle">"Proxying UDP in HTTP"</span>, <span class="seriesInfo">RFC 9298</span>, <span class="seriesInfo">DOI 10.17487/RFC9298</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9298">https://www.rfc-editor.org/rfc/rfc9298</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9458">[RFC9458]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span> and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Oblivious HTTP"</span>, <span class="seriesInfo">RFC 9458</span>, <span class="seriesInfo">DOI 10.17487/RFC9458</span>, <time datetime="2024-01" class="refDate">January 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9458">https://www.rfc-editor.org/rfc/rfc9458</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Samsung">[Samsung]</dt>
        <dd>
<span class="refAuthor">Tingfeng Yu</span>, <span class="refAuthor">James Henderson</span>, <span class="refAuthor">Alwen Tiu</span>, and <span class="refAuthor">Thomas Haines</span>, <span class="refTitle">"Privacy Analysis of Samsung’s Crowd-Sourced Bluetooth Location Tracking System"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://www.usenix.org/system/files/sec23winter-prepub-498-yu.pdf">https://www.usenix.org/system/files/sec23winter-prepub-498-yu.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WhoTracks">[WhoTracks]</dt>
      <dd>
<span class="refAuthor">Travis Mayberry</span>, <span class="refAuthor">Ellis Fenske</span>, <span class="refAuthor">Dane Brown</span>, <span class="refAuthor">Christine Fossaceca</span>, <span class="refAuthor">Sam Teplov</span>, <span class="refAuthor">Lucas Foppe</span>, <span class="refAuthor">Jeremey Martin</span>, and <span class="refAuthor">Erik Rye</span>, <span class="refTitle">"Who Tracks the Trackers?"</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/3463676.3485616">https://dl.acm.org/doi/10.1145/3463676.3485616</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO acknowledge.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christine Fossaceca</span></div>
<div dir="auto" class="left"><span class="org">Microsoft</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:cfossaceca@microsoft.com" class="email">cfossaceca@microsoft.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Eric Rescorla</span></div>
<div dir="auto" class="left"><span class="org">Windy Hill Systems, LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ekr@rtfm.com" class="email">ekr@rtfm.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
